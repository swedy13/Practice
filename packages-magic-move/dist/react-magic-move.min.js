!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.ReactMagicMove=e()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module){function callOnNthCall(n,fn){var calls=0;return function(){return calls++,calls===n?(calls=0,fn.apply(this,arguments)):void 0}}var React="undefined"!=typeof window?window.React:"undefined"!=typeof global?global.React:null,cloneWithProps=_dereq_("react/lib/cloneWithProps"),Clones=React.createClass({displayName:"MagicMoveClones",childrenWithPositions:function(){var children=[];return React.Children.forEach(this.props.children,function(child){var style=this.props.positions[child.key],key=child.key;children.push(cloneWithProps(child,{style:style,key:key}))}.bind(this)),children.sort(function(a,b){return a.key<b.key?-1:a.key>b.key?1:0})},render:function(){return React.createElement("div",{className:"MagicMoveClones"},this.childrenWithPositions())}}),MagicMove=React.createClass({displayName:"MagicMove",getInitialState:function(){return{animating:!1}},componentDidMount:function(){this.makePortal(),this.renderClonesInitially()},componentWillUnmount:function(){document.body.removeChild(this.portalNode)},componentWillReceiveProps:function(nextProps){this.startAnimation(nextProps)},componentDidUpdate:function(prevProps){this.state.animating&&this.renderClonesToNewPositions(prevProps)},makePortal:function(){this.portalNode=document.createElement("div"),this.portalNode.style.left="-9999px",document.body.appendChild(this.portalNode)},addTransitionEndEvent:function(){this._transitionHandler=callOnNthCall(this.props.children.length,this.finishAnimation),this.portalNode.addEventListener("transitionend",this._transitionHandler)},removeTransitionEndEvent:function(){this.portalNode.removeEventListener("transitionend",this._transitionHandler)},startAnimation:function(nextProps){this.state.animating||(this.addTransitionEndEvent(),nextProps.animating=!0,nextProps.positions=this.getPositions(),this.renderClones(nextProps,function(){this.setState({animating:!0})}.bind(this)))},renderClonesToNewPositions:function(prevProps){prevProps.positions=this.getPositions(),this.renderClones(prevProps)},finishAnimation:function(){this.removeTransitionEndEvent(),this.portalNode.style.position="absolute",this.setState({animating:!1})},getPositions:function(){var positions={};return React.Children.forEach(this.props.children,function(child){var ref=child.key,node=this.refs[ref].getDOMNode(),rect=node.getBoundingClientRect(),computedStyle=getComputedStyle(node),marginTop=parseInt(computedStyle.marginTop,10),marginLeft=parseInt(computedStyle.marginLeft,10),position={top:rect.top-marginTop,left:rect.left-marginLeft,width:rect.width,height:rect.height,position:"absolute"};positions[ref]=position}.bind(this)),positions},renderClonesInitially:function(){this.props.positions=this.getPositions(),React.render(React.createElement(Clones,React.__spread({},this.props)),this.portalNode)},renderClones:function(props,cb){this.portalNode.style.position="",React.render(React.createElement(Clones,React.__spread({},props)),this.portalNode,cb)},childrenWithRefs:function(){return React.Children.map(this.props.children,function(child){return cloneWithProps(child,{ref:child.key})})},render:function(){var style={opacity:this.state.animating?0:1};return React.createElement("div",{style:style},this.childrenWithRefs())}});module.exports=MagicMove},{"react/lib/cloneWithProps":8}],2:[function(_dereq_,module){module.exports=_dereq_("./components/MagicMove")},{"./components/MagicMove":1}],3:[function(_dereq_,module){function assign(target){if(null==target)throw new TypeError("Object.assign target cannot be null or undefined");for(var to=Object(target),hasOwnProperty=Object.prototype.hasOwnProperty,nextIndex=1;nextIndex<arguments.length;nextIndex++){var nextSource=arguments[nextIndex];if(null!=nextSource){var from=Object(nextSource);for(var key in from)hasOwnProperty.call(from,key)&&(to[key]=from[key])}}return to}module.exports=assign},{}],4:[function(_dereq_,module){"use strict";var assign=_dereq_("./Object.assign"),ReactContext={current:{},withContext:function(newContext,scopedCallback){var result,previousContext=ReactContext.current;ReactContext.current=assign({},previousContext,newContext);try{result=scopedCallback()}finally{ReactContext.current=previousContext}return result}};module.exports=ReactContext},{"./Object.assign":3}],5:[function(_dereq_,module){"use strict";var ReactCurrentOwner={current:null};module.exports=ReactCurrentOwner},{}],6:[function(_dereq_,module){"use strict";var ReactContext=_dereq_("./ReactContext"),ReactCurrentOwner=_dereq_("./ReactCurrentOwner"),RESERVED_PROPS=(_dereq_("./warning"),{key:!0,ref:!0}),ReactElement=function(type,key,ref,owner,context,props){this.type=type,this.key=key,this.ref=ref,this._owner=owner,this._context=context,this.props=props};ReactElement.prototype={_isReactElement:!0},ReactElement.createElement=function(type,config,children){var propName,props={},key=null,ref=null;if(null!=config){ref=void 0===config.ref?null:config.ref,key=null==config.key?null:""+config.key;for(propName in config)config.hasOwnProperty(propName)&&!RESERVED_PROPS.hasOwnProperty(propName)&&(props[propName]=config[propName])}var childrenLength=arguments.length-2;if(1===childrenLength)props.children=children;else if(childrenLength>1){for(var childArray=Array(childrenLength),i=0;childrenLength>i;i++)childArray[i]=arguments[i+2];props.children=childArray}if(type.defaultProps){var defaultProps=type.defaultProps;for(propName in defaultProps)"undefined"==typeof props[propName]&&(props[propName]=defaultProps[propName])}return new ReactElement(type,key,ref,ReactCurrentOwner.current,ReactContext.current,props)},ReactElement.createFactory=function(type){var factory=ReactElement.createElement.bind(null,type);return factory.type=type,factory},ReactElement.cloneAndReplaceProps=function(oldElement,newProps){var newElement=new ReactElement(oldElement.type,oldElement.key,oldElement.ref,oldElement._owner,oldElement._context,newProps);return newElement},ReactElement.isValidElement=function(object){var isElement=!(!object||!object._isReactElement);return isElement},module.exports=ReactElement},{"./ReactContext":4,"./ReactCurrentOwner":5,"./warning":13}],7:[function(_dereq_,module){"use strict";function createTransferStrategy(mergeStrategy){return function(props,key,value){props[key]=props.hasOwnProperty(key)?mergeStrategy(props[key],value):value}}function transferInto(props,newProps){for(var thisKey in newProps)if(newProps.hasOwnProperty(thisKey)){var transferStrategy=TransferStrategies[thisKey];transferStrategy&&TransferStrategies.hasOwnProperty(thisKey)?transferStrategy(props,thisKey,newProps[thisKey]):props.hasOwnProperty(thisKey)||(props[thisKey]=newProps[thisKey])}return props}var assign=_dereq_("./Object.assign"),emptyFunction=_dereq_("./emptyFunction"),invariant=_dereq_("./invariant"),joinClasses=_dereq_("./joinClasses"),transferStrategyMerge=(_dereq_("./warning"),createTransferStrategy(function(a,b){return assign({},b,a)})),TransferStrategies={children:emptyFunction,className:createTransferStrategy(joinClasses),style:transferStrategyMerge},ReactPropTransferer={TransferStrategies:TransferStrategies,mergeProps:function(oldProps,newProps){return transferInto(assign({},oldProps),newProps)},Mixin:{transferPropsTo:function(element){return invariant(element._owner===this),transferInto(element.props,this.props),element}}};module.exports=ReactPropTransferer},{"./Object.assign":3,"./emptyFunction":9,"./invariant":10,"./joinClasses":11,"./warning":13}],8:[function(_dereq_,module){"use strict";function cloneWithProps(child,props){var newProps=ReactPropTransferer.mergeProps(props,child.props);return!newProps.hasOwnProperty(CHILDREN_PROP)&&child.props.hasOwnProperty(CHILDREN_PROP)&&(newProps.children=child.props.children),ReactElement.createElement(child.type,newProps)}var ReactElement=_dereq_("./ReactElement"),ReactPropTransferer=_dereq_("./ReactPropTransferer"),keyOf=_dereq_("./keyOf"),CHILDREN_PROP=(_dereq_("./warning"),keyOf({children:null}));module.exports=cloneWithProps},{"./ReactElement":6,"./ReactPropTransferer":7,"./keyOf":12,"./warning":13}],9:[function(_dereq_,module){function makeEmptyFunction(arg){return function(){return arg}}function emptyFunction(){}emptyFunction.thatReturns=makeEmptyFunction,emptyFunction.thatReturnsFalse=makeEmptyFunction(!1),emptyFunction.thatReturnsTrue=makeEmptyFunction(!0),emptyFunction.thatReturnsNull=makeEmptyFunction(null),emptyFunction.thatReturnsThis=function(){return this},emptyFunction.thatReturnsArgument=function(arg){return arg},module.exports=emptyFunction},{}],10:[function(_dereq_,module){"use strict";var invariant=function(condition,format,a,b,c,d,e,f){if(!condition){var error;if(void 0===format)error=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var args=[a,b,c,d,e,f],argIndex=0;error=new Error("Invariant Violation: "+format.replace(/%s/g,function(){return args[argIndex++]}))}throw error.framesToPop=1,error}};module.exports=invariant},{}],11:[function(_dereq_,module){"use strict";function joinClasses(className){className||(className="");var nextClass,argLength=arguments.length;if(argLength>1)for(var ii=1;argLength>ii;ii++)nextClass=arguments[ii],nextClass&&(className=(className?className+" ":"")+nextClass);return className}module.exports=joinClasses},{}],12:[function(_dereq_,module){var keyOf=function(oneKeyObj){var key;for(key in oneKeyObj)if(oneKeyObj.hasOwnProperty(key))return key;return null};module.exports=keyOf},{}],13:[function(_dereq_,module){"use strict";var emptyFunction=_dereq_("./emptyFunction"),warning=emptyFunction;module.exports=warning},{"./emptyFunction":9}]},{},[2])(2)});